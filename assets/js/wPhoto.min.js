"use strict";
define("wPhoto", ["lodash", "react", "core", "santaProps", "utils", "image", "zoomedImage", "imageClientApi"], function(t, i, n, e, o, a, s, r) {
    function c(t, i) {
        return i && ("goToLink" === t || !t) || "zoomMode" === t
    }

    function p(n, e, o, a, s, r, p, d, h) {
        var l = {
            style: {}
        };
        return l.style.width = s.width, l.style.height = s.height, c(a, o) && (l.style.cursor = "pointer"), "zoomMode" === a ? t.assign(l, d(h, r, n, null, e, null)) : !o || "goToLink" !== a && a ? l.parentConst = i.DOM.div : t.assign(l, p(o, h, r)), l
    }

    function d(t, i) {
        return this.createChildComponent(this.props.compData, t, "img", i)
    }

    function h(t, i) {
        return {
            id: t.id + "img",
            ref: "img",
            containerWidth: i.width,
            containerHeight: i.height,
            displayMode: D[t.compProp.displayMode] || t.compProp.displayMode,
            effectName: t.compProp.effectName,
            imageData: t.compData,
            addItemProp: t.addItemProp
        }
    }

    function l(i, n, e) {
        var o;
        return this.state.isInZoom ? (i.className = this.classSet({
            zoomedin: !0
        }), i.initialClickPosition = this.state.initialClickPosition, o = d.call(this, "core.components.ZoomedImage", i), n.onMouseLeave = f.bind(this), n.onMouseEnter = P.bind(this)) : (i.className = this.classSet({
            zoomedout: !0
        }), o = d.call(this, "core.components.Image", i), n.onMouseLeave = t.noop, n.onMouseEnter = t.noop), t.assign(e, n), o
    }

    function g(t, i, n, e) {
        var o = h(this.props, t),
            a = {
                onClick: u.bind(this)
            };
        return !n || y(i, t) ? d.call(this, "core.components.Image", o) : l.call(this, o, a, e)
    }

    function m(i, n, e, o) {
        var a = {
            style: t.cloneDeep(i)
        };
        return a.style.width = n.width, a.style.height = n.height, a["data-exact-height"] = n.exactHeight, a["data-content-padding-horizontal"] = e.contentPaddingHorizontal, a["data-content-padding-vertical"] = e.contentPaddingVertical, a.title = o, a
    }

    function u(t) {
        var i = this,
            n = this.state.isInZoom;
        this.registerReLayout(), n ? this.refs.img.zoomOut(function() {
            i.setState({
                isInZoom: !n
            })
        }) : this.setState({
            isInZoom: !n,
            initialClickPosition: {
                clientX: t.clientX,
                clientY: t.clientY
            }
        })
    }

    function f(t) {
        var i = this;
        P.call(this), this.zoomTimer = setTimeout(function() {
            u.apply(i, [t])
        }, C)
    }

    function P() {
        clearTimeout(this.zoomTimer)
    }

    function y(t, i) {
        return t.width < i.width || t.height < i.height
    }

    function I(t, i) {
        var n = {},
            e = parseInt(t.contentPaddingLeft.value || 0, 10) + parseInt(i.contentPaddingLeft || 0, 10),
            o = parseInt(t.contentPaddingRight.value || 0, 10) + parseInt(i.contentPaddingRight || 0, 10),
            a = parseInt(t.contentPaddingTop.value || 0, 10) + parseInt(i.contentPaddingTop || 0, 10),
            s = parseInt(t.contentPaddingBottom.value || 0, 10) + parseInt(i.contentPaddingBottom || 0, 10);
        return n.contentPaddingHorizontal = e + o, n.contentPaddingVertical = a + s, n
    }

    function T(t, i) {
        var n = t.width - i.contentPaddingHorizontal,
            e = t.height - i.contentPaddingVertical;
        return {
            width: n > 0 ? n : 16,
            height: e > 0 ? e : 16
        }
    }

    function k(t, i) {
        return {
            width: t.width + i.contentPaddingHorizontal,
            height: t.height + i.contentPaddingVertical,
            exactHeight: (t.exactHeight || t.height) + i.contentPaddingVertical
        }
    }
    var v = o.linkRenderer,
        w = n.compMixins,
        C = 1200,
        D = {
            fitWidthStrict: r.fittingTypes.LEGACY_FIT_WIDTH,
            fitHeightStrict: r.fittingTypes.LEGACY_FIT_HEIGHT
        };
    return {
        displayName: "WPhoto",
        propTypes: t.assign({
            id: e.Types.Component.id,
            compData: e.Types.Component.compData.isRequired,
            compProp: e.Types.Component.compProp.isRequired,
            structure: e.Types.Component.structure,
            linkRenderInfo: e.Types.Link.linkRenderInfo.isRequired,
            rootNavigationInfo: e.Types.Component.rootNavigationInfo.isRequired
        }, e.santaTypesUtils.getSantaTypesByDefinition(a), e.santaTypesUtils.getSantaTypesByDefinition(s)),
        statics: {
            useSantaTypes: !0
        },
        mixins: [w.skinBasedComp, w.skinInfo, w.animationsMixin],
        getInitialState: function() {
            return this.zoomTimer = null, {
                isInZoom: !1
            }
        },
        getSkinProperties: function() {
            var i = this.props.structure.propertyQuery,
                n = this.props.compData.link || null,
                e = this.props.compProp.onClickBehavior,
                a = this.props.compProp.displayMode,
                s = t.pick(this.props.style, ["width", "height"]),
                r = {
                    width: this.props.compData.width,
                    height: this.props.compData.height
                },
                c = I(this.getParams(["contentPaddingLeft", "contentPaddingRight", "contentPaddingBottom", "contentPaddingTop"]), this.getSkinExports()),
                d = o.imageUtils.getContainerSize(T(s, c), r, D[a] || a),
                h = k(d, c),
                l = m(this.props.style, h, c, this.props.compData.title);
            return {
                "": l,
                img: g.call(this, d, r, "zoomAndPanMode" === e, l),
                link: p(this.props.compData, i, n, e, d, this.props.rootNavigationInfo, v.renderLink, v.renderImageZoomLink, this.props.linkRenderInfo)
            }
        },
        getDefaultSkinName: function() {
            return "wysiwyg.viewer.skins.photo.DefaultPhoto"
        }
    }
});
//# sourceMappingURL=wPhoto.min.js.map